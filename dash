#!/usr/bin/python
# -*- coding: utf-8 -*-
# vim :set tabstop=4 expandtab shiftwidth=4 softtabstop=4

import time

from render import *
from gpio.switch import *
from utils.logger import log


# name:  skin name
# font:  font name
# fontC: font color
# backC: background color
skins = [
       {'name': 'oemDay',   'font': 'fonts/digital7.ttf', 'fontC': (36,44,43), 'backC': (165,186,145)},
       {'name': 'oemNight', 'font': 'fonts/digital7.ttf', 'fontC': (36,44,43), 'backC': (28,70,156)}
]

def updateOpt(nOpt):
    if current_option >= 0 and current_option <= nOpt: return current_option+1
    else: return 0

current_option = 1
show_logo      = True

# Pygame render
render=render_pygame(skins[0])

#GPIO switch
switch = switch()
        
while True:
    h=int(time.strftime("%H"))
    if h>19 or h<7: render.changeSkin(skins[1]) 
    else: render.changeSkin(skins[0]) 
 	
    if show_logo: 
        render.drawLogo()
        time.sleep(4)
        show_logo=False

    log.debug("Soy el modo: "+str(current_option))
    change = False
    while(change==False):
        render.options[current_option]()
        if switch.read(0)==1: change=True
        time.sleep(0.3)
    current_option=updateOpt(len(render.options)-2)
    log.debug("Salgo del antiguo modo ahora soy: "+str(current_option))

